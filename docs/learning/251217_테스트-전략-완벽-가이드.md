# í…ŒìŠ¤íŠ¸ ì „ëµ ì™„ë²½ ê°€ì´ë“œ (LookMarket)

> **ì‘ì„±ì¼ì‹œ**: 2025-12-17 22:30
>
> LookMarket í”„ë¡œì íŠ¸ì˜ í…ŒìŠ¤íŠ¸ ì „ëµì„ ì •ë¦¬í•œ ë¬¸ì„œì…ë‹ˆë‹¤.
> Testcontainers, Mock, í†µí•© í…ŒìŠ¤íŠ¸ ë“± í…ŒìŠ¤íŠ¸ ê´€ë ¨ ê°œë…ê³¼ ì‹¤ì œ ì ìš© ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## ëª©ì°¨

1. [í…ŒìŠ¤íŠ¸ì˜ ê¸°ë³¸ ê°œë…](#1-í…ŒìŠ¤íŠ¸ì˜-ê¸°ë³¸-ê°œë…)
2. [í…ŒìŠ¤íŠ¸ ë ˆë²¨ ì •ì˜](#2-í…ŒìŠ¤íŠ¸-ë ˆë²¨-ì •ì˜)
3. [í…ŒìŠ¤íŠ¸ ë”ë¸” (Test Doubles)](#3-í…ŒìŠ¤íŠ¸-ë”ë¸”-test-doubles)
4. [Testcontainersë€?](#4-testcontainersë€)
5. [í…ŒìŠ¤íŠ¸ ë°ì´í„° ê²©ë¦¬ ì „ëµ](#5-í…ŒìŠ¤íŠ¸-ë°ì´í„°-ê²©ë¦¬-ì „ëµ)
6. [LookMarket í…ŒìŠ¤íŠ¸ ì „ëµ](#6-lookmarket-í…ŒìŠ¤íŠ¸-ì „ëµ)
7. [ì‹¤ì „ ì˜ˆì‹œ ì½”ë“œ](#7-ì‹¤ì „-ì˜ˆì‹œ-ì½”ë“œ)
8. [ì°¸ê³ : sample(LoopPak) í”„ë¡œì íŠ¸ íŒ¨í„´](#8-ì°¸ê³ -samplelooppak-í”„ë¡œì íŠ¸-íŒ¨í„´)
9. [í…ŒìŠ¤íŠ¸ íŒŒì¼ ë¶„ë¥˜ ê·œì¹™](#9-í…ŒìŠ¤íŠ¸-íŒŒì¼-ë¶„ë¥˜-ê·œì¹™)

---

## 1. í…ŒìŠ¤íŠ¸ì˜ ê¸°ë³¸ ê°œë…

### ì™œ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•˜ëŠ”ê°€?

1. **ë²„ê·¸ ì¡°ê¸° ë°œê²¬**: ì½”ë“œ ë³€ê²½ ì‹œ ê¸°ì¡´ ê¸°ëŠ¥ì´ ê¹¨ì§€ëŠ”ì§€ ì¦‰ì‹œ í™•ì¸
2. **ë¦¬íŒ©í† ë§ ì•ˆì „ë§**: í…ŒìŠ¤íŠ¸ê°€ ìˆìœ¼ë©´ ê³¼ê°í•˜ê²Œ ì½”ë“œë¥¼ ê°œì„ í•  ìˆ˜ ìˆìŒ
3. **ë¬¸ì„œ ì—­í• **: í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” "ì´ ê¸°ëŠ¥ì´ ì–´ë–»ê²Œ ë™ì‘í•´ì•¼ í•˜ëŠ”ì§€" ë³´ì—¬ì¤Œ
4. **ì„¤ê³„ ê°œì„ **: í…ŒìŠ¤íŠ¸í•˜ê¸° ì–´ë ¤ìš´ ì½”ë“œ = ì„¤ê³„ê°€ ì˜ëª»ëœ ì½”ë“œ

### ì¢‹ì€ í…ŒìŠ¤íŠ¸ì˜ íŠ¹ì§• (FIRST ì›ì¹™)

| ì›ì¹™ | ì˜ë¯¸ | ì„¤ëª… |
|------|------|------|
| **F**ast | ë¹ ë¦„ | í…ŒìŠ¤íŠ¸ëŠ” ë¹¨ë¼ì•¼ ìì£¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŒ |
| **I**solated | ê²©ë¦¬ë¨ | í…ŒìŠ¤íŠ¸ë¼ë¦¬ ì˜í–¥ì„ ì£¼ì§€ ì•Šì•„ì•¼ í•¨ |
| **R**epeatable | ë°˜ë³µ ê°€ëŠ¥ | ì–¸ì œ ì‹¤í–‰í•´ë„ ê°™ì€ ê²°ê³¼ |
| **S**elf-validating | ìê°€ ê²€ì¦ | ì„±ê³µ/ì‹¤íŒ¨ê°€ ëª…í™•í•´ì•¼ í•¨ |
| **T**imely | ì ì‹œì„± | ê¸°ëŠ¥ êµ¬í˜„ê³¼ í•¨ê»˜ ì‘ì„± |

---

## 2. í…ŒìŠ¤íŠ¸ ë ˆë²¨ ì •ì˜

### í…ŒìŠ¤íŠ¸ í”¼ë¼ë¯¸ë“œ

```
                    /\
                   /  \
                  / E2E \        â† ì ê²Œ, ëŠë¦¬ì§€ë§Œ ì „ì²´ ê²€ì¦
                 /--------\
                /          \
               / Integration \   â† ì¤‘ê°„, DB/ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™ ê²€ì¦
              /--------------\
             /                \
            /      Unit        \  â† ë§ì´, ë¹ ë¥´ê²Œ, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê²€ì¦
           /--------------------\
```

### ê° ë ˆë²¨ì˜ íŠ¹ì§•

| ë ˆë²¨ | ì†ë„ | ë²”ìœ„ | ë¹„ìš© | ë¹„ìœ¨ |
|------|------|------|------|------|
| **Unit (ë‹¨ìœ„)** | ë§¤ìš° ë¹ ë¦„ | í´ë˜ìŠ¤/ë©”ì„œë“œ | ë‚®ìŒ | 70% |
| **Integration (í†µí•©)** | ë³´í†µ | ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ | ì¤‘ê°„ | 20% |
| **E2E (End-to-End)** | ëŠë¦¼ | ì „ì²´ ì‹œìŠ¤í…œ | ë†’ìŒ | 10% |

### ì™œ í”¼ë¼ë¯¸ë“œ í˜•íƒœì¸ê°€?

- **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**ëŠ” ë¹ ë¥´ê³  ì €ë ´í•˜ë¯€ë¡œ ë§ì´ ì‘ì„±
- **E2E í…ŒìŠ¤íŠ¸**ëŠ” ëŠë¦¬ê³  ê¹¨ì§€ê¸° ì‰¬ìš°ë¯€ë¡œ í•µì‹¬ í”Œë¡œìš°ë§Œ
- í”¼ë¼ë¯¸ë“œê°€ ë’¤ì§‘íˆë©´(E2Eê°€ ë§ìœ¼ë©´) í…ŒìŠ¤íŠ¸ ì‹¤í–‰ì´ ëŠë ¤ì§€ê³  ìœ ì§€ë³´ìˆ˜ ì–´ë ¤ì›€

---

### ğŸ§± ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (Unit Test)

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ëŒ€ìƒ** | ë„ë©”ì¸ ëª¨ë¸ (Entity, VO, Domain Service) |
| **ëª©ì ** | ìˆœìˆ˜ ë¡œì§ì˜ ì •í•©ì„±ê³¼ ê·œì¹™ ê²€ì¦ |
| **í™˜ê²½** | Spring ì—†ì´ ìˆœìˆ˜ JVMì—ì„œ ì‹¤í–‰ / **í…ŒìŠ¤íŠ¸ ëŒ€ì—­**ì„ í™œìš©í•´ ëª¨ë“  ì˜ì¡´ì„± ëŒ€ì²´ |
| **ê¸°ìˆ ** | JUnit5, AssertJ, Mockito |

> **ì˜ˆì‹œ**: í¬ì¸íŠ¸ ì¶©ì „ ì‹œ ìµœëŒ€ í•œë„ ì´ˆê³¼ ì—¬ë¶€ë¥¼ ê²€ì¦í•˜ëŠ” í…ŒìŠ¤íŠ¸

```java
// Spring ì—†ì´ ìˆœìˆ˜ Javaë¡œ í…ŒìŠ¤íŠ¸
class PointTest {
    @Test
    void ìµœëŒ€_í•œë„_ì´ˆê³¼ì‹œ_ì˜ˆì™¸ë°œìƒ() {
        Point point = new Point(900_000L);  // í˜„ì¬ 90ë§Œ í¬ì¸íŠ¸

        assertThatThrownBy(() -> point.charge(200_000L))  // 20ë§Œ ì¶”ê°€ ì‹œë„
            .isInstanceOf(IllegalArgumentException.class)
            .hasMessage("í¬ì¸íŠ¸ í•œë„ë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤");
    }
}
```

---

### ğŸ” í†µí•© í…ŒìŠ¤íŠ¸ (Integration Test)

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ëŒ€ìƒ** | Application Service, Facade ë“± ê³„ì¸µ ë¡œì§ |
| **ëª©ì ** | ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸(Repo, Domain, ì™¸ë¶€ API Stub)ê°€ ì—°ê²°ëœ ìƒíƒœì—ì„œ **ë¹„ì¦ˆë‹ˆìŠ¤ íë¦„ ì „ì²´ë¥¼ ê²€ì¦** |
| **í™˜ê²½** | `@SpringBootTest`, ì‹¤ì œ Bean êµ¬ì„±, Test DB |
| **ê¸°ìˆ ** | SpringBootTest + Testcontainers (ë˜ëŠ” H2) |

> **ì˜ˆì‹œ**: ì‹¤ì œ í¬ì¸íŠ¸ê°€ ì¶©ì „ë˜ê³ , DBì— ë°˜ì˜ë˜ë©°, ì´ë²¤íŠ¸ê°€ ë°œí–‰ë˜ëŠ” ì „ ê³¼ì •ì„ ê²€ì¦

```java
@SpringBootTest
class PointServiceIntegrationTest {
    @Autowired
    private PointService pointService;

    @Autowired
    private PointRepository pointRepository;

    @Test
    void í¬ì¸íŠ¸_ì¶©ì „_ì „ì²´_íë¦„() {
        // given
        Long userId = 1L;

        // when
        pointService.charge(userId, 10_000L);

        // then - ì‹¤ì œ DBì—ì„œ ì¡°íšŒí•˜ì—¬ ê²€ì¦
        Point point = pointRepository.findByUserId(userId).orElseThrow();
        assertThat(point.getAmount()).isEqualTo(10_000L);
    }
}
```

---

### ğŸŒ E2E í…ŒìŠ¤íŠ¸ (End-to-End Test)

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ëŒ€ìƒ** | ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ (Controller â†’ Service â†’ DB) |
| **ëª©ì ** | ì‹¤ì œ HTTP ìš”ì²­ ë‹¨ìœ„ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ |
| **í™˜ê²½** | `MockMvc` ë˜ëŠ” `TestRestTemplate`ì„ í†µí•´ ì‹¤ì œ API ìš”ì²­ ì‹œë®¬ë ˆì´ì…˜ |
| **ê¸°ìˆ ** | SpringBootTest + `@AutoConfigureMockMvc`, `WebTestClient` ë“± |

> **ì˜ˆì‹œ**: ì‚¬ìš©ìê°€ íšŒì›ê°€ì… â†’ í¬ì¸íŠ¸ ì¶©ì „ â†’ ì£¼ë¬¸ íë¦„ì„ HTTP ìš”ì²­ìœ¼ë¡œ ìˆ˜í–‰í–ˆì„ ë•Œì˜ ê²°ê³¼ í™•ì¸

```java
@SpringBootTest(webEnvironment = WebEnvironment.RANDOM_PORT)
class OrderE2ETest {
    @Autowired
    private TestRestTemplate restTemplate;

    @Test
    void ì£¼ë¬¸_ìƒì„±_API_ì„±ê³µ() {
        // given
        OrderRequest request = new OrderRequest(productId, 2);
        HttpHeaders headers = new HttpHeaders();
        headers.setBearerAuth(jwtToken);

        // when
        ResponseEntity<OrderResponse> response = restTemplate.exchange(
            "/api/v1/orders",
            HttpMethod.POST,
            new HttpEntity<>(request, headers),
            OrderResponse.class
        );

        // then
        assertThat(response.getStatusCode()).isEqualTo(HttpStatus.CREATED);
        assertThat(response.getBody().getOrderId()).isNotNull();
    }
}
```

---

## 3. í…ŒìŠ¤íŠ¸ ë”ë¸” (Test Doubles)

### ì •ì˜

**í…ŒìŠ¤íŠ¸ ë”ë¸”**ì€ í…ŒìŠ¤íŠ¸ ëŒ€ìƒì´ ì˜ì¡´í•˜ëŠ” ì™¸ë¶€ ê°ì²´ì˜ ë™ì‘ì„ **ë¹ ë¥´ê³  ì•ˆì „í•˜ê²Œ í‰ë‚´ ë‚´ëŠ” ëŒ€ì—­ ê°ì²´**ì…ë‹ˆë‹¤.

ëŠë¦¬ê³  ë¶ˆì•ˆì •í•œ ì‹¤ì œ êµ¬í˜„(DB, ì™¸ë¶€ API ë“±) ëŒ€ì‹ , í…ŒìŠ¤íŠ¸ í™˜ê²½ì— ë§ëŠ” **'ì¡°ìš©í•œ ëŒ€ì—­'**ì„ ì„¸ì›Œì¤ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë¬¸ì œ ìƒí™©: AuthServiceë¥¼ í…ŒìŠ¤íŠ¸í•˜ê³  ì‹¶ì€ë°...               â”‚
â”‚                                                             â”‚
â”‚   AuthService â†’ UserRepository â†’ Database                   â”‚
â”‚                                                             â”‚
â”‚ - Database ì—°ê²°ì´ í•„ìš”í•¨ (ëŠë¦¼)                              â”‚
â”‚ - í…ŒìŠ¤íŠ¸ ë°ì´í„° ì¤€ë¹„ê°€ í•„ìš”í•¨ (ë²ˆê±°ë¡œì›€)                     â”‚
â”‚ - DB ìƒíƒœì— ë”°ë¼ í…ŒìŠ¤íŠ¸ ê²°ê³¼ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ (ë¶ˆì•ˆì •)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ í•´ê²°: í…ŒìŠ¤íŠ¸ ë”ë¸” ì‚¬ìš©                                       â”‚
â”‚                                                             â”‚
â”‚   AuthService â†’ TestDouble(UserRepository)                  â”‚
â”‚                                                             â”‚
â”‚ - Database ì—°ê²° ë¶ˆí•„ìš” (ë¹ ë¦„)                                â”‚
â”‚ - ì›í•˜ëŠ” ì‘ë‹µì„ ì§ì ‘ ì§€ì • (ê°„í¸)                             â”‚
â”‚ - í•­ìƒ ë™ì¼í•œ ê²°ê³¼ (ì•ˆì •ì )                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ§© ë„êµ¬ vs ì—­í• : í•µì‹¬ ê°œë…

> **ì¤‘ìš”**: `Stub`, `Mock`, `Spy`, `Fake`ëŠ” **í…ŒìŠ¤íŠ¸ ëª©ì (ì—­í• )**ì´ê³ ,
> `mock()`, `spy()`ëŠ” **ê°ì²´ ìƒì„± ë°©ì‹(ë„êµ¬)**ì…ë‹ˆë‹¤.

```java
// ë„êµ¬: mock()ìœ¼ë¡œ ê°ì²´ ìƒì„±
UserRepository repo = mock(UserRepository.class);

// ì—­í•  1: Stub - ê³ ì •ëœ ì‘ë‹µ ì œê³µ
given(repo.findById(1L)).willReturn(Optional.of(user));

// ì—­í•  2: Mock - í˜¸ì¶œ ì—¬ë¶€ ê²€ì¦
verify(repo).findById(1L);
```

**í•˜ë‚˜ì˜ mock ê°ì²´ì— Stub + Mock ì—­í• ì„ ë™ì‹œì— ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.**

---

### ğŸ“š í…ŒìŠ¤íŠ¸ ë”ë¸” ì—­í• ë³„ ì •ë¦¬

| ì—­í•  | ëª©ì  | ì‚¬ìš© ë°©ì‹ | ì˜ˆì‹œ |
|------|------|----------|------|
| **Dummy** | ìë¦¬ë§Œ ì±„ì›€ (ì‚¬ìš©ë˜ì§€ ì•ŠìŒ) | ìƒì„±ì ë“±ì—ì„œ ì „ë‹¬ | `new Service(null, null)` |
| **Stub** | ê³ ì •ëœ ì‘ë‹µ ì œê³µ (ìƒíƒœ ê¸°ë°˜) | `when().thenReturn()` | `repo.find()` â†’ í•­ìƒ íŠ¹ì • ìœ ì € ë°˜í™˜ |
| **Mock** | í˜¸ì¶œ ì—¬ë¶€/íšŸìˆ˜ ê²€ì¦ (í–‰ìœ„ ê¸°ë°˜) | `verify(...)` | í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ì—ˆëŠ”ì§€ ê²€ì¦ |
| **Spy** | ì§„ì§œ ê°ì²´ ê°ì‹¸ê¸° + ì¼ë¶€ ì¡°ì‘ | `spy()` + `doReturn()` | ì§„ì§œ ì„œë¹„ìŠ¤ ê°ì‹¸ê³  ì¼ë¶€ë§Œ stub |
| **Fake** | ì‹¤ì œì²˜ëŸ¼ ë™ì‘í•˜ëŠ” ê°€ì§œ êµ¬í˜„ì²´ | ì§ì ‘ í´ë˜ìŠ¤ êµ¬í˜„ | `InMemoryUserRepository` |

---

### ğŸ“¦ Stub ì˜ˆì œ

**ëª©ì **: íë¦„ë§Œ í†µì œí•˜ê³  ì‹¶ì€ ê²½ìš° - "ì´ë ‡ê²Œ í˜¸ì¶œí•˜ë©´, ì´ë ‡ê²Œ ì‘ë‹µí•´ì¤˜"

```java
@Test
void Stub_ì˜ˆì œ_ê³ ì •ì‘ë‹µ() {
    // given - Stub ì„¤ì •
    UserRepository userRepo = mock(UserRepository.class);
    given(userRepo.findById(1L)).willReturn(Optional.of(new User("í™ê¸¸ë™")));

    UserService service = new UserService(userRepo);

    // when
    User user = service.getUser(1L);

    // then - ì‘ë‹µ ê°’ ê²€ì¦ (ìƒíƒœ ê¸°ë°˜)
    assertThat(user.getName()).isEqualTo("í™ê¸¸ë™");
}
```

---

### ğŸ“¬ Mock ì˜ˆì œ

**ëª©ì **: í˜¸ì¶œ ì—¬ë¶€ê°€ ê²€ì¦ ëŒ€ìƒ - "ë„ˆ ì´ë ‡ê²Œ ë™ì‘í–ˆë‹ˆ?"

```java
@Test
void Mock_ì˜ˆì œ_í˜¸ì¶œê²€ì¦() {
    // given
    NotificationService notifier = mock(NotificationService.class);
    OrderService orderService = new OrderService(notifier);

    // when
    orderService.completeOrder(orderId);

    // then - í˜¸ì¶œ ì—¬ë¶€ ê²€ì¦ (í–‰ìœ„ ê¸°ë°˜)
    verify(notifier, times(1)).sendOrderCompletedEmail(orderId);
}
```

---

### ğŸ•µï¸ Spy ì˜ˆì œ

**ëª©ì **: ì§„ì§œ ê°ì²´ì²˜ëŸ¼ ë™ì‘í•˜ë©´ì„œ ì¼ë¶€ë§Œ ì¡°ì‘/ê²€ì¦ - "ë¡œì§ì€ ê·¸ëŒ€ë¡œ ì“°ê³ , íŠ¹ì • ë™ì‘ë§Œ ë®ì–´ì”Œìš°ê³  ì‹¶ë‹¤"

```java
@Test
void Spy_ì˜ˆì œ_ì‹¤ì œê°ì²´_ì¼ë¶€ì¡°ì‘() {
    // given - ì‹¤ì œ ê°ì²´ë¥¼ spyë¡œ ê°ì‹¸ê¸°
    UserService realService = new UserService(userRepository);
    UserService spyService = spy(realService);

    // íŠ¹ì • ë©”ì„œë“œë§Œ stubìœ¼ë¡œ ë®ì–´ì”Œìš°ê¸°
    doReturn(true).when(spyService).isVipUser(anyLong());

    // when - ë‚˜ë¨¸ì§€ ë¡œì§ì€ ì‹¤ì œë¡œ ë™ì‘
    boolean result = spyService.canAccessPremiumContent(userId);

    // then
    assertThat(result).isTrue();
    verify(spyService).isVipUser(userId);  // í˜¸ì¶œ ê²€ì¦ë„ ê°€ëŠ¥
}
```

**@MockitoSpyBean (Spring Boot 3.4+)**:
```java
@SpringBootTest
class UserApplicationServiceTest {
    @MockitoSpyBean  // ì‹¤ì œ Beanì„ Spyë¡œ ê°ì‹¸ì„œ ì£¼ì…
    private UserRepository userRepository;

    @Test
    void íšŒì›ê°€ì…ì‹œ_ì €ì¥ì´_ìˆ˜í–‰ëœë‹¤() {
        userService.register(request);

        // ì‹¤ì œ DBì— ì €ì¥ë˜ë©´ì„œ + í˜¸ì¶œ ê²€ì¦ë„ ê°€ëŠ¥
        verify(userRepository, times(1)).save(any(User.class));
    }
}
```

---

### ğŸ§ª Fake ì˜ˆì œ

**ëª©ì **: ì‹¤ì œ DB ì—†ì´ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ ì €ì¥ì†Œ êµ¬í˜„ - "ì™„ì „íˆ ë…ë¦½ì ì¸ í…ŒìŠ¤íŠ¸ í™˜ê²½ì´ í•„ìš”í•  ë•Œ"

```java
// Fake êµ¬í˜„ì²´ - ì‹¤ì œì²˜ëŸ¼ ë™ì‘í•˜ì§€ë§Œ ë©”ëª¨ë¦¬ì— ì €ì¥
public class InMemoryUserRepository implements UserRepository {
    private final Map<Long, User> storage = new HashMap<>();
    private Long idSequence = 1L;

    @Override
    public User save(User user) {
        if (user.getId() == null) {
            // ID ìë™ ìƒì„± (ì‹¤ì œ DBì²˜ëŸ¼)
            User newUser = user.withId(idSequence++);
            storage.put(newUser.getId(), newUser);
            return newUser;
        }
        storage.put(user.getId(), user);
        return user;
    }

    @Override
    public Optional<User> findById(Long id) {
        return Optional.ofNullable(storage.get(id));
    }

    @Override
    public Optional<User> findByEmail(String email) {
        return storage.values().stream()
            .filter(u -> u.getEmail().equals(email))
            .findFirst();
    }

    @Override
    public void delete(User user) {
        storage.remove(user.getId());
    }

    // í…ŒìŠ¤íŠ¸ ìœ í‹¸ë¦¬í‹°
    public void clear() {
        storage.clear();
        idSequence = 1L;
    }
}
```

**Fake ì‚¬ìš© ì˜ˆì‹œ**:
```java
class UserServiceTest {
    private InMemoryUserRepository userRepository;
    private UserService userService;

    @BeforeEach
    void setUp() {
        userRepository = new InMemoryUserRepository();
        userService = new UserService(userRepository);
    }

    @AfterEach
    void tearDown() {
        userRepository.clear();  // í…ŒìŠ¤íŠ¸ ê²©ë¦¬
    }

    @Test
    void ì‚¬ìš©ì_ì €ì¥_í›„_ì¡°íšŒ() {
        // given
        User user = User.create("test@email.com", "password", "í™ê¸¸ë™");

        // when
        User saved = userService.register(user);
        User found = userService.findById(saved.getId());

        // then
        assertThat(found.getEmail()).isEqualTo("test@email.com");
    }
}
```

---

### ğŸ¯ í…ŒìŠ¤íŠ¸ ë”ë¸” ì„ íƒ ê°€ì´ë“œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Q: ì–´ë–¤ í…ŒìŠ¤íŠ¸ ë”ë¸”ì„ ì‚¬ìš©í• ê¹Œ?                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚ "ê·¸ëƒ¥ ìë¦¬ë§Œ ì±„ìš°ë©´ ë¼" â†’ Dummy                               â”‚
â”‚                                                             â”‚
â”‚ "íŠ¹ì • ì‘ë‹µì„ ë°˜í™˜í•˜ê²Œ í•˜ê³  ì‹¶ì–´" â†’ Stub                       â”‚
â”‚     given(repo.findById(1L)).willReturn(user);              â”‚
â”‚                                                             â”‚
â”‚ "ì´ ë©”ì„œë“œê°€ í˜¸ì¶œëëŠ”ì§€ í™•ì¸í•˜ê³  ì‹¶ì–´" â†’ Mock                  â”‚
â”‚     verify(service).sendEmail(any());                       â”‚
â”‚                                                             â”‚
â”‚ "ì‹¤ì œ ê°ì²´ ì“°ë©´ì„œ ì¼ë¶€ë§Œ ë°”ê¾¸ê³  ì‹¶ì–´" â†’ Spy                   â”‚
â”‚     doReturn(true).when(spyService).isVip();                â”‚
â”‚                                                             â”‚
â”‚ "ì‹¤ì œì²˜ëŸ¼ ë™ì‘í•˜ëŠ” ê°€ì§œê°€ í•„ìš”í•´" â†’ Fake                      â”‚
â”‚     InMemoryUserRepository                                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Mockito ê¸°ë³¸ ì‚¬ìš©ë²•

```java
@ExtendWith(MockitoExtension.class)
class AuthServiceTest {

    @Mock  // ê°€ì§œ ê°ì²´ ìƒì„±
    private UserRepository userRepository;

    @Mock
    private PasswordEncoder passwordEncoder;

    @InjectMocks  // Mockë“¤ì„ ì£¼ì…ë°›ì€ ì‹¤ì œ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ
    private AuthService authService;

    @Test
    void ë¡œê·¸ì¸_ì„±ê³µ() {
        // given - Stub ì„¤ì •
        User mockUser = User.reconstitute(1L, "test@email.com", "encodedPw", ...);
        given(userRepository.findByEmail("test@email.com"))
            .willReturn(Optional.of(mockUser));
        given(passwordEncoder.matches("rawPassword", "encodedPw"))
            .willReturn(true);

        // when - í…ŒìŠ¤íŠ¸ ëŒ€ìƒ ì‹¤í–‰
        User result = authService.authenticate("test@email.com", "rawPassword");

        // then - ê²°ê³¼ ê²€ì¦
        assertThat(result.getId()).isEqualTo(1L);

        // Mock í˜¸ì¶œ ê²€ì¦ (ì„ íƒì )
        verify(userRepository).findByEmail("test@email.com");
    }
}
```

---

### í…ŒìŠ¤íŠ¸ ë”ë¸” ì‚¬ìš©ì˜ ì¥ë‹¨ì 

**ì¥ì **:
- ë¹ ë¦„ (DB ì—°ê²° ë¶ˆí•„ìš”)
- ê²©ë¦¬ë¨ (ì™¸ë¶€ ì˜ì¡´ì„± ì œê±°)
- ì˜ˆì™¸ ìƒí™© í…ŒìŠ¤íŠ¸ ìš©ì´ (ì›í•˜ëŠ” ë™ì‘ ì§€ì • ê°€ëŠ¥)

**ë‹¨ì **:
- ì‹¤ì œ ë™ì‘ê³¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ
- Mock ì„¤ì •ì´ ë³µì¡í•´ì§ˆ ìˆ˜ ìˆìŒ
- ê³¼ë„í•œ Mockì€ í…ŒìŠ¤íŠ¸ì˜ ì‹ ë¢°ë„ ì €í•˜

**ê¶Œì¥**:
- **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**: Stub/Mock ì ê·¹ í™œìš©
- **í†µí•© í…ŒìŠ¤íŠ¸**: ì‹¤ì œ DB (Testcontainers) ì‚¬ìš©, í•„ìš” ì‹œ ì™¸ë¶€ APIë§Œ Stub
- **E2E í…ŒìŠ¤íŠ¸**: ê°€ëŠ¥í•œ ì‹¤ì œ í™˜ê²½, ì™¸ë¶€ ì‹œìŠ¤í…œë§Œ Mock

---

## 4. Testcontainersë€?

### ì •ì˜

**Testcontainers**ëŠ” í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì‹œ Docker ì»¨í…Œì´ë„ˆë¥¼ ìë™ìœ¼ë¡œ ë„ì›Œì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤.
ì‹¤ì œ MySQL, Redis, Kafka ë“±ì„ í…ŒìŠ¤íŠ¸ ì „ìš©ìœ¼ë¡œ ë„ì›Œì„œ **ì§„ì§œ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸**í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.

### ì™œ Testcontainersë¥¼ ì‚¬ìš©í•˜ëŠ”ê°€?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ê¸°ì¡´ ë°©ì‹ì˜ ë¬¸ì œì                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. H2 ì¸ë©”ëª¨ë¦¬ DB ì‚¬ìš©                                       â”‚
â”‚    - MySQLê³¼ ë¬¸ë²•/ë™ì‘ì´ ë‹¤ë¦„                                â”‚
â”‚    - í”„ë¡œë•ì…˜ì—ì„œë§Œ ë°œê²¬ë˜ëŠ” ë²„ê·¸ ì¡´ì¬                        â”‚
â”‚                                                             â”‚
â”‚ 2. ë¡œì»¬ MySQL ì‚¬ìš©                                          â”‚
â”‚    - ê°œë°œìë§ˆë‹¤ DB ìƒíƒœê°€ ë‹¤ë¦„                               â”‚
â”‚    - í…ŒìŠ¤íŠ¸ ë°ì´í„°ê°€ ì‹¤ì œ ë°ì´í„°ì™€ ì„ì¼ ìˆ˜ ìˆìŒ               â”‚
â”‚    - CI/CD í™˜ê²½ ì„¤ì • ë³µì¡                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Testcontainers í•´ê²°ì±…                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. ì§„ì§œ MySQL ì»¨í…Œì´ë„ˆ ì‚¬ìš©                                  â”‚
â”‚    - í”„ë¡œë•ì…˜ê³¼ ë™ì¼í•œ í™˜ê²½                                  â”‚
â”‚    - ì‹¤ì œ SQL ë¬¸ë²•/ë™ì‘ ê²€ì¦ ê°€ëŠ¥                            â”‚
â”‚                                                             â”‚
â”‚ 2. í…ŒìŠ¤íŠ¸ ì „ìš© ê²©ë¦¬ëœ ì»¨í…Œì´ë„ˆ                               â”‚
â”‚    - í…ŒìŠ¤íŠ¸ ì‹œì‘ ì‹œ ìë™ ìƒì„±, ì¢…ë£Œ ì‹œ ìë™ ì‚­ì œ             â”‚
â”‚    - ë‹¤ë¥¸ í™˜ê²½ê³¼ ì™„ì „íˆ ë¶„ë¦¬ë¨                               â”‚
â”‚    - CI/CDì—ì„œë„ ë™ì¼í•˜ê²Œ ë™ì‘                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë™ì‘ ì›ë¦¬

```
í…ŒìŠ¤íŠ¸ ì‹œì‘
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Docker ì»¨í…Œì´ë„ˆ  â”‚  â† Testcontainersê°€ ìë™ìœ¼ë¡œ ìƒì„±
â”‚ (MySQL 8.0)     â”‚
â”‚ Port: ëœë¤      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (ì‹¤ì œ DB ì‚¬ìš©)
    â”‚
    â–¼
í…ŒìŠ¤íŠ¸ ì¢…ë£Œ
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì»¨í…Œì´ë„ˆ ì‚­ì œ   â”‚  â† ìë™ ì •ë¦¬
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ê¸°ë³¸ ì‚¬ìš©ë²•

```java
@DataJpaTest
@Testcontainers
@AutoConfigureTestDatabase(replace = AutoConfigureTestDatabase.Replace.NONE)
class JpaUserRepositoryIntegrationTest {

    // 1. ì»¨í…Œì´ë„ˆ ì •ì˜
    @Container
    static MySQLContainer<?> mysql = new MySQLContainer<>("mysql:8.0")
            .withDatabaseName("testdb")
            .withUsername("test")
            .withPassword("test");

    // 2. Spring ì„¤ì •ì— ì»¨í…Œì´ë„ˆ ì •ë³´ ì£¼ì…
    @DynamicPropertySource
    static void configureProperties(DynamicPropertyRegistry registry) {
        registry.add("spring.datasource.url", mysql::getJdbcUrl);
        registry.add("spring.datasource.username", mysql::getUsername);
        registry.add("spring.datasource.password", mysql::getPassword);
        registry.add("spring.datasource.driver-class-name", () -> "com.mysql.cj.jdbc.Driver");
    }

    @Autowired
    private JpaUserRepository userRepository;

    @Test
    void ì‚¬ìš©ì_ì €ì¥_ì„±ê³µ() {
        // ì‹¤ì œ MySQL ì»¨í…Œì´ë„ˆì—ì„œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        User user = User.create("test@email.com", "password", "í™ê¸¸ë™", ...);
        User saved = userRepository.save(user);

        assertThat(saved.getId()).isNotNull();
    }
}
```

### ì–´ë…¸í…Œì´ì…˜ ì„¤ëª…

| ì–´ë…¸í…Œì´ì…˜ | ì—­í•  |
|-----------|------|
| `@Testcontainers` | Testcontainers ê¸°ëŠ¥ í™œì„±í™” |
| `@Container` | í…ŒìŠ¤íŠ¸ìš© Docker ì»¨í…Œì´ë„ˆ ì •ì˜ |
| `@DynamicPropertySource` | ì»¨í…Œì´ë„ˆ ì •ë³´ë¥¼ Spring ì„¤ì •ì— ë™ì  ì£¼ì… |
| `@AutoConfigureTestDatabase(replace = NONE)` | ë‚´ì¥ DB ëŒ€ì‹  ì™¸ë¶€ DB ì‚¬ìš© |

### H2 vs Testcontainers ë¹„êµ

| í•­ëª© | H2 ì¸ë©”ëª¨ë¦¬ | Testcontainers |
|------|-------------|----------------|
| ì†ë„ | ë§¤ìš° ë¹ ë¦„ | ì²« ì‹¤í–‰ ì‹œ ëŠë¦¼ (ì»¨í…Œì´ë„ˆ ìƒì„±) |
| í™˜ê²½ ì¼ì¹˜ | ë‚®ìŒ (MySQLê³¼ ë‹¤ë¦„) | ë†’ìŒ (ì‹¤ì œ MySQL) |
| SQL í˜¸í™˜ì„± | ì¼ë¶€ ê¸°ëŠ¥ ë¯¸ì§€ì› | ì™„ì „ í˜¸í™˜ |
| ì„¤ì • ë³µì¡ë„ | ë‚®ìŒ | ì¤‘ê°„ (Docker í•„ìš”) |
| CI/CD | ê°„ë‹¨ | Docker í•„ìš” |

**ê¶Œì¥**:
- **ë‹¨ìˆœ CRUD í…ŒìŠ¤íŠ¸** â†’ H2ë„ ê°€ëŠ¥
- **ë³µì¡í•œ ì¿¼ë¦¬, í”„ë¡œë•ì…˜ í™˜ê²½ ê²€ì¦** â†’ Testcontainers ê¶Œì¥

### ì»¨í…Œì´ë„ˆ ì¬ì‚¬ìš© (ì„±ëŠ¥ ìµœì í™”)

í…ŒìŠ¤íŠ¸ë§ˆë‹¤ ì»¨í…Œì´ë„ˆë¥¼ ìƒˆë¡œ ë„ìš°ë©´ ëŠë¦½ë‹ˆë‹¤. ì¬ì‚¬ìš© ì„¤ì •:

```properties
# ~/.testcontainers.properties
testcontainers.reuse.enable=true
```

```java
@Container
static MySQLContainer<?> mysql = new MySQLContainer<>("mysql:8.0")
        .withReuse(true);  // ì»¨í…Œì´ë„ˆ ì¬ì‚¬ìš©
```

---

## 5. í…ŒìŠ¤íŠ¸ ë°ì´í„° ê²©ë¦¬ ì „ëµ

### ë¬¸ì œ: í…ŒìŠ¤íŠ¸ ê°„ ë°ì´í„° ê°„ì„­

```
í…ŒìŠ¤íŠ¸ A: ì‚¬ìš©ì "test@email.com" ì €ì¥
    â”‚
    â–¼
í…ŒìŠ¤íŠ¸ B: ì‚¬ìš©ì "test@email.com" ì €ì¥ ì‹œë„ â†’ ì‹¤íŒ¨! (ì¤‘ë³µ)
```

í…ŒìŠ¤íŠ¸ ìˆœì„œì— ë”°ë¼ ê²°ê³¼ê°€ ë‹¬ë¼ì§€ë©´ ì•ˆ ë©ë‹ˆë‹¤.

### í•´ê²°ì±… ë¹„êµ

| ë°©ì‹ | ì„¤ëª… | ì¥ì  | ë‹¨ì  |
|------|------|------|------|
| **@Transactional ë¡¤ë°±** | í…ŒìŠ¤íŠ¸ í›„ ìë™ ë¡¤ë°± | ê°„ë‹¨, ë¹ ë¦„ | commit ê²€ì¦ ë¶ˆê°€ |
| **DatabaseCleanUp** | í…ŒìŠ¤íŠ¸ í›„ TRUNCATE | commit ê²€ì¦ ê°€ëŠ¥ | ì•½ê°„ ëŠë¦¼ |
| **ëœë¤ ë°ì´í„°** | ë§¤ë²ˆ ë‹¤ë¥¸ ë°ì´í„° ì‚¬ìš© | ì¶©ëŒ ì—†ìŒ | ë””ë²„ê¹… ì–´ë ¤ì›€ |

### ë°©ì‹ 1: @Transactional ë¡¤ë°± (ê¸°ë³¸ ê¶Œì¥)

```java
@DataJpaTest
@Transactional  // í…ŒìŠ¤íŠ¸ í›„ ìë™ ë¡¤ë°±
class UserRepositoryTest {

    @Test
    void ì €ì¥_í…ŒìŠ¤íŠ¸() {
        userRepository.save(user);
        // í…ŒìŠ¤íŠ¸ ì¢…ë£Œ ì‹œ ìë™ìœ¼ë¡œ ë¡¤ë°±ë¨
    }
}
```

**ì–¸ì œ ì‚¬ìš©?**
- Repository í…ŒìŠ¤íŠ¸
- ë‹¨ìˆœ CRUD ê²€ì¦
- ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ê°€ í•„ìš”í•  ë•Œ

**í•œê³„**:
- `@Transactional`ì´ ë¶™ìœ¼ë©´ ì‹¤ì œë¡œ commitë˜ì§€ ì•ŠìŒ
- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ(`@TransactionalEventListener(phase = AFTER_COMMIT)`) í…ŒìŠ¤íŠ¸ ë¶ˆê°€
- íŠ¸ëœì­ì…˜ ì „íŒŒ ë¬¸ì œ ë°œê²¬ ì–´ë ¤ì›€

### ë°©ì‹ 2: DatabaseCleanUp (sample í”„ë¡œì íŠ¸ íŒ¨í„´)

```java
@Component
public class DatabaseCleanUp implements InitializingBean {

    @PersistenceContext
    private EntityManager entityManager;

    private final List<String> tableNames = new ArrayList<>();

    @Override
    public void afterPropertiesSet() {
        // @Entityê°€ ë¶™ì€ í´ë˜ìŠ¤ì˜ í…Œì´ë¸”ëª…ì„ ìë™ ìˆ˜ì§‘
        entityManager.getMetamodel().getEntities().stream()
            .filter(entity -> entity.getJavaType().getAnnotation(Entity.class) != null)
            .map(entity -> entity.getJavaType().getAnnotation(Table.class).name())
            .forEach(tableNames::add);
    }

    @Transactional
    public void truncateAllTables() {
        entityManager.flush();
        entityManager.createNativeQuery("SET FOREIGN_KEY_CHECKS = 0").executeUpdate();

        for (String table : tableNames) {
            entityManager.createNativeQuery("TRUNCATE TABLE `" + table + "`").executeUpdate();
        }

        entityManager.createNativeQuery("SET FOREIGN_KEY_CHECKS = 1").executeUpdate();
    }
}
```

**ì‚¬ìš©ë²•**:
```java
@SpringBootTest
class OrderIntegrationTest {

    @Autowired
    private DatabaseCleanUp databaseCleanUp;

    @AfterEach
    void tearDown() {
        databaseCleanUp.truncateAllTables();  // ë§¤ í…ŒìŠ¤íŠ¸ í›„ ì „ì²´ í…Œì´ë¸” ì´ˆê¸°í™”
    }

    @Test
    void ì£¼ë¬¸_ìƒì„±_í›„_ì´ë²¤íŠ¸_ë°œí–‰() {
        // ì‹¤ì œë¡œ commitë˜ê³ , ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë„ ë™ì‘í•¨
    }
}
```

**ì–¸ì œ ì‚¬ìš©?**
- íŠ¸ëœì­ì…˜ commit ê²€ì¦ì´ í•„ìš”í•  ë•Œ
- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ í…ŒìŠ¤íŠ¸
- ì—¬ëŸ¬ íŠ¸ëœì­ì…˜ì— ê±¸ì¹œ ì‹œë‚˜ë¦¬ì˜¤

### LookMarket ê¶Œì¥ ì „ëµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Repository í…ŒìŠ¤íŠ¸ â†’ @Transactional ë¡¤ë°± (ë¹ ë¦„)              â”‚
â”‚ Service ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ â†’ Mock ì‚¬ìš© (ë¹ ë¦„)                      â”‚
â”‚ Service í†µí•© í…ŒìŠ¤íŠ¸ â†’ DatabaseCleanUp (commit ê²€ì¦)         â”‚
â”‚ E2E í…ŒìŠ¤íŠ¸ â†’ MockMvc + @MockBean (ë¹ ë¦„)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. LookMarket í…ŒìŠ¤íŠ¸ ì „ëµ

### í…ŒìŠ¤íŠ¸ ë ˆë²¨ë³„ ê°€ì´ë“œ

| ë ˆë²¨ | ëª¨ë“ˆ | ì–´ë…¸í…Œì´ì…˜ | ë°ì´í„° ê²©ë¦¬ | ìš©ë„ |
|------|------|-----------|------------|------|
| **Domain Unit** | lookmarket-domain | ì—†ìŒ | ë¶ˆí•„ìš” | ì—”í‹°í‹° ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ |
| **Service Unit** | lookmarket-application | @ExtendWith(MockitoExtension) | Mock ì‚¬ìš© | ì„œë¹„ìŠ¤ ë¡œì§ |
| **Repository Integration** | lookmarket-infrastructure | @DataJpaTest + @Testcontainers | @Transactional | ì¿¼ë¦¬ ê²€ì¦ |
| **Service Integration** | lookmarket-application | @SpringBootTest + Testcontainers | DatabaseCleanUp | íŠ¸ëœì­ì…˜ ê²€ì¦ |
| **E2E (Controller)** | lookmarket-api | @WebMvcTest | @MockBean | API ê²€ì¦ |

### ì–´ë–¤ í…ŒìŠ¤íŠ¸ë¥¼ ì–¸ì œ ì„ íƒí• ê¹Œ?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Q: ë¬´ì—‡ì„ ê²€ì¦í•˜ë ¤ëŠ”ê°€?                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚ "ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ë§Œ ê²€ì¦í•˜ê³  ì‹¶ë‹¤"                              â”‚
â”‚     â†’ Domain Unit Test (ìˆœìˆ˜ Java)                          â”‚
â”‚     â†’ Service Unit Test (Mock ì‚¬ìš©)                         â”‚
â”‚                                                             â”‚
â”‚ "SQL ì¿¼ë¦¬ê°€ ì œëŒ€ë¡œ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ê³  ì‹¶ë‹¤"                  â”‚
â”‚     â†’ Repository Integration Test (Testcontainers)          â”‚
â”‚                                                             â”‚
â”‚ "íŠ¸ëœì­ì…˜ì´ ì œëŒ€ë¡œ commit/rollback ë˜ëŠ”ì§€ í™•ì¸í•˜ê³  ì‹¶ë‹¤"      â”‚
â”‚     â†’ Service Integration Test (DatabaseCleanUp)            â”‚
â”‚                                                             â”‚
â”‚ "API ìš”ì²­/ì‘ë‹µì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•˜ê³  ì‹¶ë‹¤"                      â”‚
â”‚     â†’ E2E Test (MockMvc)                                    â”‚
â”‚                                                             â”‚
â”‚ "ì „ì²´ ì‹œìŠ¤í…œì´ í†µí•©ë˜ì–´ ì˜ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ê³  ì‹¶ë‹¤"          â”‚
â”‚     â†’ E2E Test (TestRestTemplate + ì‹¤ì œ ì„œë²„)               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í…ŒìŠ¤íŠ¸ ë„¤ì´ë° ê·œì¹™

**í´ë˜ìŠ¤ëª…**:
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸: `{ëŒ€ìƒ}Test` (ì˜ˆ: `AuthServiceTest`)
- í†µí•© í…ŒìŠ¤íŠ¸: `{ëŒ€ìƒ}IntegrationTest` (ì˜ˆ: `JpaUserRepositoryIntegrationTest`)

**ë©”ì„œë“œëª…**: `@DisplayName` í•œê¸€ ì‚¬ìš© ê¶Œì¥

```java
@Test
@DisplayName("ì¡´ì¬í•˜ëŠ” ì´ë©”ì¼ë¡œ ì¡°íšŒí•˜ë©´ ì‚¬ìš©ìë¥¼ ë°˜í™˜í•œë‹¤")
void findByEmail_existingEmail_returnsUser() {
    // ...
}
```

**@Nestedë¡œ ê·¸ë£¹í•‘**:

```java
@DisplayName("AuthService ë‹¨ìœ„ í…ŒìŠ¤íŠ¸")
class AuthServiceTest {

    @Nested
    @DisplayName("ë¡œê·¸ì¸ ì¸ì¦ (authenticate)")
    class Authenticate {

        @Test
        @DisplayName("ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ë©´ ì‚¬ìš©ìë¥¼ ë°˜í™˜í•œë‹¤")
        void authenticate_success() { }

        @Test
        @DisplayName("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì´ë©”ì¼ì´ë©´ ì˜ˆì™¸ê°€ ë°œìƒí•œë‹¤")
        void authenticate_userNotFound_throwsException() { }
    }

    @Nested
    @DisplayName("í† í° ê°±ì‹  ê²€ì¦ (validateUserForRefresh)")
    class ValidateUserForRefresh {
        // ...
    }
}
```

---

## 7. ì‹¤ì „ ì˜ˆì‹œ ì½”ë“œ

### 7-1. Domain Unit Test (ìˆœìˆ˜ Java)

```java
// lookmarket-domain/src/test/java/.../UserTest.java
class UserTest {

    @Nested
    @DisplayName("User ìƒì„±")
    class Create {

        @Test
        @DisplayName("ìœ íš¨í•œ ì •ë³´ë¡œ Userë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤")
        void create_withValidInfo_success() {
            // given
            String email = "test@example.com";
            String password = "encodedPassword";
            String name = "í™ê¸¸ë™";

            // when
            User user = User.create(email, password, name, null, UserRole.CUSTOMER);

            // then
            assertThat(user.getEmail()).isEqualTo(email);
            assertThat(user.getName()).isEqualTo(name);
            assertThat(user.getStatus()).isEqualTo(UserStatus.ACTIVE);
        }
    }

    @Nested
    @DisplayName("ì´ë©”ì¼ ë³€ê²½")
    class ChangeEmail {

        @Test
        @DisplayName("ìœ íš¨í•œ ì´ë©”ì¼ë¡œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤")
        void changeEmail_withValidEmail_success() {
            // given
            User user = createTestUser();
            String newEmail = "new@example.com";

            // when
            user.changeEmail(newEmail);

            // then
            assertThat(user.getEmail()).isEqualTo(newEmail);
        }
    }

    private User createTestUser() {
        return User.create("test@example.com", "password", "í…ŒìŠ¤íŠ¸", null, UserRole.CUSTOMER);
    }
}
```

### 7-2. Service Unit Test (Mock ì‚¬ìš©)

```java
// lookmarket-application/src/test/java/.../AuthServiceTest.java
@DisplayName("AuthService ë‹¨ìœ„ í…ŒìŠ¤íŠ¸")
@ExtendWith(MockitoExtension.class)
class AuthServiceTest {

    @InjectMocks
    private AuthService authService;

    @Mock
    private UserRepository userRepository;

    @Mock
    private PasswordEncoder passwordEncoder;

    @Nested
    @DisplayName("ë¡œê·¸ì¸ ì¸ì¦ (authenticate)")
    class Authenticate {

        @Test
        @DisplayName("ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ë©´ ì‚¬ìš©ìë¥¼ ë°˜í™˜í•œë‹¤")
        void authenticate_success() {
            // given
            String email = "test@example.com";
            String rawPassword = "password123";
            User mockUser = createMockUser(1L, email, "encodedPassword", UserStatus.ACTIVE);

            given(userRepository.findByEmail(email)).willReturn(Optional.of(mockUser));
            given(passwordEncoder.matches(rawPassword, "encodedPassword")).willReturn(true);

            // when
            User result = authService.authenticate(email, rawPassword);

            // then
            assertThat(result).isNotNull();
            assertThat(result.getId()).isEqualTo(1L);
            assertThat(result.getEmail()).isEqualTo(email);
        }

        @Test
        @DisplayName("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì´ë©”ì¼ì´ë©´ ì˜ˆì™¸ê°€ ë°œìƒí•œë‹¤")
        void authenticate_userNotFound_throwsException() {
            // given
            given(userRepository.findByEmail(anyString())).willReturn(Optional.empty());

            // when & then
            assertThatThrownBy(() -> authService.authenticate("notfound@example.com", "password"))
                    .isInstanceOf(AuthenticationException.class)
                    .hasMessageContaining("ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤");
        }
    }
}
```

### 7-3. Repository Integration Test (Testcontainers)

```java
// lookmarket-infrastructure/src/test/java/.../JpaUserRepositoryIntegrationTest.java
@DisplayName("JpaUserRepository í†µí•© í…ŒìŠ¤íŠ¸")
@DataJpaTest
@Testcontainers
@AutoConfigureTestDatabase(replace = AutoConfigureTestDatabase.Replace.NONE)
@Import(TestConfiguration.class)
class JpaUserRepositoryIntegrationTest {

    @Container
    static MySQLContainer<?> mysql = new MySQLContainer<>("mysql:8.0")
            .withDatabaseName("testdb")
            .withUsername("test")
            .withPassword("test");

    @DynamicPropertySource
    static void configureProperties(DynamicPropertyRegistry registry) {
        registry.add("spring.datasource.url", mysql::getJdbcUrl);
        registry.add("spring.datasource.username", mysql::getUsername);
        registry.add("spring.datasource.password", mysql::getPassword);
        registry.add("spring.datasource.driver-class-name", () -> "com.mysql.cj.jdbc.Driver");
        registry.add("spring.jpa.hibernate.ddl-auto", () -> "create-drop");
    }

    @Autowired
    private JpaUserRepository jpaUserRepository;

    @Autowired
    private SpringDataUserRepository springDataUserRepository;

    @BeforeEach
    void setUp() {
        springDataUserRepository.deleteAll();  // í…ŒìŠ¤íŠ¸ ê²©ë¦¬
    }

    @Nested
    @DisplayName("save ë©”ì„œë“œ")
    class SaveTest {

        @Test
        @DisplayName("ìƒˆ ì‚¬ìš©ìë¥¼ ì €ì¥í•˜ë©´ IDê°€ ìƒì„±ëœë‹¤")
        void save_newUser_generatesId() {
            // given
            User user = createTestUser("save@test.com");

            // when
            User saved = jpaUserRepository.save(user);

            // then
            assertThat(saved.getId()).isNotNull();
            assertThat(saved.getEmail()).isEqualTo("save@test.com");
        }
    }

    @Nested
    @DisplayName("findByEmail ë©”ì„œë“œ")
    class FindByEmailTest {

        @Test
        @DisplayName("ì¡´ì¬í•˜ëŠ” ì´ë©”ì¼ë¡œ ì¡°íšŒí•˜ë©´ ì‚¬ìš©ìë¥¼ ë°˜í™˜í•œë‹¤")
        void findByEmail_existingEmail_returnsUser() {
            // given
            User user = createTestUser("find@test.com");
            jpaUserRepository.save(user);

            // when
            Optional<User> found = jpaUserRepository.findByEmail("find@test.com");

            // then
            assertThat(found).isPresent();
            assertThat(found.get().getEmail()).isEqualTo("find@test.com");
        }
    }

    private User createTestUser(String email) {
        return User.create(email, "password", "í…ŒìŠ¤íŠ¸", "010-1234-5678", UserRole.CUSTOMER);
    }
}
```

### 7-4. E2E Test (MockMvc)

```java
// lookmarket-api/src/test/java/.../UserControllerTest.java
@DisplayName("UserController E2E í…ŒìŠ¤íŠ¸")
@WebMvcTest(UserController.class)
@Import(SecurityConfig.class)  // Security ì„¤ì • í¬í•¨
class UserControllerTest {

    @Autowired
    private MockMvc mockMvc;

    @Autowired
    private ObjectMapper objectMapper;

    @MockBean
    private UserService userService;

    @Nested
    @DisplayName("POST /api/v1/users - íšŒì›ê°€ì…")
    class Register {

        @Test
        @DisplayName("ìœ íš¨í•œ ìš”ì²­ì´ë©´ 201 Createdë¥¼ ë°˜í™˜í•œë‹¤")
        void register_validRequest_returns201() throws Exception {
            // given
            UserRegisterRequest request = new UserRegisterRequest(
                "test@example.com", "password123", "í™ê¸¸ë™", "010-1234-5678"
            );

            User mockUser = User.reconstitute(1L, "test@example.com", ...);
            given(userService.register(any())).willReturn(mockUser);

            // when & then
            mockMvc.perform(post("/api/v1/users")
                    .contentType(MediaType.APPLICATION_JSON)
                    .content(objectMapper.writeValueAsString(request)))
                .andExpect(status().isCreated())
                .andExpect(jsonPath("$.id").value(1))
                .andExpect(jsonPath("$.email").value("test@example.com"))
                .andExpect(jsonPath("$.name").value("í™ê¸¸ë™"));
        }

        @Test
        @DisplayName("ì´ë©”ì¼ í˜•ì‹ì´ ì˜ëª»ë˜ë©´ 400 Bad Requestë¥¼ ë°˜í™˜í•œë‹¤")
        void register_invalidEmail_returns400() throws Exception {
            // given
            UserRegisterRequest request = new UserRegisterRequest(
                "invalid-email", "password123", "í™ê¸¸ë™", "010-1234-5678"
            );

            // when & then
            mockMvc.perform(post("/api/v1/users")
                    .contentType(MediaType.APPLICATION_JSON)
                    .content(objectMapper.writeValueAsString(request)))
                .andExpect(status().isBadRequest());
        }
    }
}
```

---

## 8. ì°¸ê³ : sample(LoopPak) í”„ë¡œì íŠ¸ íŒ¨í„´

LookMarket í…ŒìŠ¤íŠ¸ ì „ëµì€ sample(LoopPak) í”„ë¡œì íŠ¸ì˜ íŒ¨í„´ì„ ì°¸ê³ í–ˆìŠµë‹ˆë‹¤.

### sample í”„ë¡œì íŠ¸ í…ŒìŠ¤íŠ¸ êµ¬ì¡°

```
apps/commerce-api/src/test/java/com/loopers/
â”œâ”€â”€ domain/           # ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (ìˆœìˆ˜ Java)
â”‚   â”œâ”€â”€ users/UserTest.java
â”‚   â”œâ”€â”€ order/OrderTest.java
â”‚   â””â”€â”€ product/ProductTest.java
â”‚
â”œâ”€â”€ application/      # Service í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ users/UserApplicationServiceTest.java      # @SpringBootTest + @MockitoSpyBean
â”‚   â”œâ”€â”€ order/OrderUsecaseIntegrationTest.java     # í†µí•© í…ŒìŠ¤íŠ¸
â”‚   â””â”€â”€ order/OrderConcurrencyTest.java            # ë™ì‹œì„± í…ŒìŠ¤íŠ¸
â”‚
â””â”€â”€ interfaces/api/   # E2E í…ŒìŠ¤íŠ¸
    â”œâ”€â”€ users/UserV1ApiE2ETest.java                # TestRestTemplate
    â””â”€â”€ orders/OrderV1ApiE2ETest.java
```

### sample í”„ë¡œì íŠ¸ì˜ í•µì‹¬ íŒ¨í„´

#### 1. DatabaseCleanUp (testFixtures ëª¨ë“ˆ)

```java
// modules/jpa/src/testFixtures/java/com/loopers/utils/DatabaseCleanUp.java
@Component
public class DatabaseCleanUp implements InitializingBean {
    // @Entity í…Œì´ë¸” ìë™ ìˆ˜ì§‘ í›„ TRUNCATE
}
```

#### 2. @MockitoSpyBean ì‚¬ìš©

```java
@SpringBootTest
class UserApplicationServiceTest {
    @MockitoSpyBean  // ì‹¤ì œ êµ¬í˜„ì²´ë¥¼ Spyë¡œ ê°ì‹¸ì„œ verify ê°€ëŠ¥
    private UserRepository userRepository;

    @Test
    void íšŒì›ê°€ì…ì‹œ_ì €ì¥ì´_ìˆ˜í–‰ëœë‹¤() {
        userApplicationService.saveUser(...);
        verify(userRepository, times(1)).save(any(User.class));
    }
}
```

#### 3. ë™ì‹œì„± í…ŒìŠ¤íŠ¸ íŒ¨í„´

```java
@Test
void ë¹„ê´€ì ë½_ë™ì¼ì¿ í°_ë™ì‹œì£¼ë¬¸_í•˜ë‚˜ë§Œ_ì„±ê³µ() throws InterruptedException {
    int threadCount = 10;
    ExecutorService executorService = Executors.newFixedThreadPool(10);
    CountDownLatch latch = new CountDownLatch(threadCount);
    AtomicInteger successCount = new AtomicInteger(0);

    for (int i = 0; i < threadCount; i++) {
        executorService.submit(() -> {
            try {
                orderFacade.placeOrder(userId, orderInfo);
                successCount.incrementAndGet();
            } catch (Exception e) {
                // ì˜ˆìƒëœ ì‹¤íŒ¨
            } finally {
                latch.countDown();
            }
        });
    }
    latch.await();

    assertThat(successCount.get()).isEqualTo(1);  // í•˜ë‚˜ë§Œ ì„±ê³µ
}
```

### LookMarket vs sample ë¹„êµ

| í•­ëª© | sample (LoopPak) | LookMarket |
|------|------------------|------------|
| ì•„í‚¤í…ì²˜ | ë‹¨ì¼ ëª¨ë“ˆ | ë©€í‹° ëª¨ë“ˆ (Hexagonal) |
| Testcontainers | static ì‹±ê¸€í†¤ | @Container ì–´ë…¸í…Œì´ì…˜ |
| ë°ì´í„° ê²©ë¦¬ | DatabaseCleanUp | @Transactional + DatabaseCleanUp (ì„ íƒ) |
| E2E ë„êµ¬ | TestRestTemplate | MockMvc (ê¶Œì¥) |
| ì¸ì¦ | X-USER-ID í—¤ë” | JWT í† í° |

---

## 9. í…ŒìŠ¤íŠ¸ íŒŒì¼ ë¶„ë¥˜ ê·œì¹™

### íŒŒì¼ëª… ì»¨ë²¤ì…˜ (LookMarket ì±„íƒ)

| í…ŒìŠ¤íŠ¸ ë ˆë²¨ | íŒŒì¼ëª… íŒ¨í„´ | ì˜ˆì‹œ |
|------------|------------|------|
| **Unit** | `*Test.java` | `UserTest.java`, `AuthServiceTest.java` |
| **Integration** | `*IntegrationTest.java` | `JpaUserRepositoryIntegrationTest.java` |
| **E2E** | `*E2ETest.java` | `AuthControllerE2ETest.java` |

### ì™œ íŒŒì¼ëª… ì»¨ë²¤ì…˜ì„ ì„ íƒí–ˆëŠ”ê°€?

**í´ë” ë¶„ë¦¬ ë°©ì‹** (`unit/`, `integration/`, `e2e/`)ë„ ìˆì§€ë§Œ, íŒŒì¼ëª… ì»¨ë²¤ì…˜ì„ ì±„íƒí•œ ì´ìœ :

1. **ì›ë³¸ ì½”ë“œì™€ ê°™ì€ íŒ¨í‚¤ì§€ ìœ ì§€**
   ```
   src/main/java/com/lookmarket/user/UserService.java
   src/test/java/com/lookmarket/user/UserServiceTest.java  â† ê°™ì€ íŒ¨í‚¤ì§€
   ```
   - IDEì—ì„œ `Cmd+Shift+T` (Go to Test)ë¡œ ë°”ë¡œ ì´ë™ ê°€ëŠ¥
   - `package-private` ì ‘ê·¼ì í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

2. **íŒŒì¼ëª…ë§Œìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ë ˆë²¨ íŒŒì•… ê°€ëŠ¥**
   - `UserServiceTest.java` â†’ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
   - `JpaUserRepositoryIntegrationTest.java` â†’ í†µí•© í…ŒìŠ¤íŠ¸
   - `AuthControllerE2ETest.java` â†’ E2E í…ŒìŠ¤íŠ¸

### LookMarket í…ŒìŠ¤íŠ¸ íŒŒì¼ êµ¬ì¡°

```
lookmarket-domain/src/test/java/.../
â””â”€â”€ user/
    â””â”€â”€ UserTest.java                         â† ìˆœìˆ˜ Java ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

lookmarket-application/src/test/java/.../
â”œâ”€â”€ user/
â”‚   â””â”€â”€ UserServiceTest.java                  â† Mock ì‚¬ìš© ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
â””â”€â”€ auth/
    â””â”€â”€ AuthServiceTest.java                  â† Mock ì‚¬ìš© ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

lookmarket-infrastructure/src/test/java/.../
â””â”€â”€ user/
    â””â”€â”€ JpaUserRepositoryIntegrationTest.java â† Testcontainers í†µí•© í…ŒìŠ¤íŠ¸

lookmarket-api/src/test/java/.../
â”œâ”€â”€ auth/
â”‚   â””â”€â”€ AuthControllerE2ETest.java            â† MockMvc E2E í…ŒìŠ¤íŠ¸
â””â”€â”€ security/
    â””â”€â”€ JwtTokenProviderTest.java             â† ìˆœìˆ˜ Java ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
```

### ì„ íƒì : @Tag ì‚¬ìš©

í”„ë¡œì íŠ¸ ê·œëª¨ê°€ ì»¤ì§€ë©´ `@Tag`ë¥¼ ì¶”ê°€í•˜ì—¬ ì„ íƒì  ì‹¤í–‰ ê°€ëŠ¥:

```java
@Tag("unit")
class UserServiceTest { }

@Tag("integration")
class JpaUserRepositoryIntegrationTest { }
```

```bash
# ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë§Œ ì‹¤í–‰
./gradlew test -Dgroups=unit
```

**í˜„ì¬ LookMarket ê·œëª¨ì—ì„œëŠ” íŒŒì¼ëª… ì»¨ë²¤ì…˜ë§Œìœ¼ë¡œ ì¶©ë¶„í•©ë‹ˆë‹¤.**

---

## ì²´í¬ë¦¬ìŠ¤íŠ¸

í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„± ì‹œ í™•ì¸í•  ì‚¬í•­:

- [ ] í…ŒìŠ¤íŠ¸ ëŒ€ìƒì— ë§ëŠ” ë ˆë²¨ ì„ íƒ (Unit/Integration/E2E)
- [ ] ì ì ˆí•œ ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš© (@ExtendWith, @DataJpaTest, @WebMvcTest ë“±)
- [ ] í…ŒìŠ¤íŠ¸ ê°„ ë°ì´í„° ê²©ë¦¬ ë³´ì¥
- [ ] @DisplayNameìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ì˜ë„ ëª…í™•íˆ
- [ ] @Nestedë¡œ ê´€ë ¨ í…ŒìŠ¤íŠ¸ ê·¸ë£¹í•‘
- [ ] Given-When-Then íŒ¨í„´ ì¤€ìˆ˜
- [ ] Mock ì‚¬ìš© ì‹œ ê³¼ë„í•œ ì„¤ì • í”¼í•˜ê¸°

---

## ì°¸ê³  ìë£Œ

- [Testcontainers ê³µì‹ ë¬¸ì„œ](https://www.testcontainers.org/)
- [Mockito ê³µì‹ ë¬¸ì„œ](https://site.mockito.org/)
- [Spring Boot Testing ê°€ì´ë“œ](https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.testing)
- [AssertJ ê³µì‹ ë¬¸ì„œ](https://assertj.github.io/doc/)
